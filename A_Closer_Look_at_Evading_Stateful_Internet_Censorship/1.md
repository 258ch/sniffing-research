## 一、引言

如今，互联网审查和监视普遍存在。 国家层面的审查系统，如NSA的PRISM和你国的防火墙（GFW），能够实时分析全国的TB级流量。 具有明文的协议（例如，HTTP，DNS，IMAP）直接受到管理者[1,2,5,14,20,29]的监视和操纵，而具有加密的协议（例如，SSH，TLS / SSL， PPTP / MPPE）和Tor，可以通过流量指纹识别，导致后续的IP层阻塞[13,31]。

这些审查系统背后的关键技术是深度包检测（DPI）[27]，它也为网络入侵检测系统（NIDS）提供支持。 正如之前报道的那样，大多数审查NIDS都部署在主干和边界路由器的“路径上”[27,29,34]。

为了检查应用程序级有效负载，DPI技术必须正确实现TCP等底层协议，这是当今Internet的基石。 Ptacek等 [23]已经表明，任何NIDS本身都无法始终以与其终端相同的方式重建TCP流。 其根本原因是在终端主机和NIDS上TCP（以及可能的其他）协议的实现之间存在差异。 即使NIDS完美地反映了一个特定TCP实现的实现，它仍然可能在处理由另一个TCP实现生成的数据包流时出现问题。

由于封包处理中的这种模糊性，发送方可以发送精心设计的封包，使NIDS维护的TCP控制块（TCB）与接收方的TCB不同步。在某些情况下，甚至可以欺骗NIDS以完全停用TCB（例如，在接收到伪RST封包之后），有效地允许对手“操纵”NIDS上的TCB。审查监控器存在同样的基本缺陷 - 如果审查监控器上的TCB可以与服务器上的TCB成功去同步，则客户端可以绕过审查。与其他审查绕过技术（如VPN，Tor和Telex [32]）不同，它依赖于额外的网络基础设施（例如，代理节点）[27]，基于TCB操作的绕过技术只需要在客户端上制作/操纵数据包并且可以帮助所有基于TCP的应用层协议“保持在雷达之下。”基于这个想法，Khattak等人  [17]通过研究其在TCP和HTTP层的行为，探讨了针对GFW的几种实际绕过技术。西厢项目[25]提供了一个实用工具，实施了一些绕过策略，但自2011年以来已停止发展;遗憾的是，在我们的测量研究中，没有一种策略被发现有效。除了这些尝试之外，没有最近的数据点，显示这些绕过技术如何在野外发挥作用。

在这项工作中，我们广泛评估了针对GFW的TCP层审查绕过技术。 通过在你国境内分布在9个城市（和3个ISP）的11个有利位置进行测试，我们能够覆盖各种网络路径，可能包含不同类型的GFW设备和中间设备（详见第3.3节）。我们测量TCB操纵 如何帮助HTTP，DNS和Tor绕过GFW。

首先，我们测量现有的审查绕过规则如何在实践中发挥作用。 有趣的是，我们发现由于意外的网络条件，来自网络中间盒的干扰，或更重要的是GFW的新更新（与之前考虑的模型不同），其中大多数不再适用。 这些初始测量结果促使我们构建探测测试，来推断“新”更新的GFW模型。 最后，基于新的GFW模型以及在部署TCP层审查绕过方面遇到的其他实际挑战的经验教训，我们制定了一套新的绕过策略。 我们的测量结果表明，新策略具有90％或更高的绕过成功率。 我们还评估了这些新策略如何帮助HTTP，DNS，Tor和VPN绕过GFW。

此外，在我们的测量研究过程中，我们设计并实施了审查绕过工具INTANG，整合了本文考虑的所有审查绕过策略; INTANG易于扩展来包含其他策略。 它不需要配置并在后台运行来帮助正常流量绕过审查。 我们计划开源这个工具，来支持这方面的未来研究。

我们总结了我们的贡献如下：

+   到目前为止，我们使用TCP层审查绕过技术执行GFW行为的最大测量研究。 

+   我们证明现有策略要么不起作用，要么在实践中受到限制。 

+   我们根据测量结果开发出更新且更全面的GFW模型。 

+   我们提出了可以绕过新模型的新的，以测量为导向的策略。 

+   我们测量改进策略在HTTP，DNS，VPN和Tor的审查绕过方面的成功率。 结果显示非常高的成功率（> 90％）。 

我们开发了一个开源工具，可以自动测量GFW的响应能力，以及审查绕过。该工具可扩展为一个框架，用于整合未来研究中可能出现的其他绕过策略。